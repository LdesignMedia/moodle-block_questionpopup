define(["jquery","core/modal_factory","core/templates","core/str","core/notification","core/modal_events","core/ajax"],function(a,b,c,d,e,f,g){var h={debugjs:!0,contextid:0,questions:[],locale:"",answers:[],display:!1},i=function(a){"use strict";var b,c;for(b in h)h.hasOwnProperty(b)&&a.hasOwnProperty(b)&&(c=typeof h[b],"boolean"===c?h[b]=Boolean(a[b]):"number"===c?h[b]=Number(a[b]):"string"===c?h[b]=String(a[b]):h[b]=a[b])},j={},k=function(a){if(a)for(var b in console)"function"==typeof console[b]&&(j[b]=console[b].bind(window.console));else for(var c in console)"function"==typeof console[c]&&(j[c]=function(){})},l={saveAnswer:function(a){var b={methodname:"block_questionpopup_save_answer",args:{answer:a,contextid:h.contextid}};g.call([b])[0].done(function(a){200===a.result_code?window.location.reload():e.addNotification({message:a.warnings[0].message,type:"error"})}).fail(e.exception)},init:function(d){console.log(d),b.create({title:M.util.get_string("js:popup_title","block_questionpopup"),body:c.render("block_questionpopup/question",d),type:b.types.SAVE_CANCEL},a(".preview-question")).then(function(b){return b.getRoot().on(f.save,function(b){l.saveAnswer(a("form#question_popup").serialize())}),b.getRoot().on(f.hidden,function(){d.display&&b.show()}),b}).done(function(b){d.display&&b.show(),a(".modal-footer [data-action=cancel]").hide()})["catch"](e.exception)}};return{initialise:function(b){i(b),k(h.debugjs),a.noConflict(),a(document).ready(function(){j.log("Block Quesiton Popup v1.1"),l.init(h)})}}});